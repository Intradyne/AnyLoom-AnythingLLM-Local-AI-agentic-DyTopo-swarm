{
	"nodes":[
		{"id":"orchestrator","type":"text","text":"## Orchestrator\n\n**run_swarm(task, domain, tau, K_in, T_max)**\n\nAsync parallel swarm execution:\n- Backend-agnostic (llama.cpp)\n- Semaphore-controlled concurrency\n- Optional RAG context pre-fetch ‚Üí Manager round 1\n- Round 1: parallel broadcast via asyncio.gather\n- Rounds 2+: tiered parallel execution\n- Manager-driven coordination\n- Convergence detection & termination\n- Aegean consensus early termination\n- Post-run memory persistence\n\nüìç [orchestrator.py](../src/dytopo/orchestrator.py)","x":80,"y":-100,"width":340,"height":520,"color":"4"},
		{"id":"safeguards","type":"text","text":"## Safeguards\n\nPerformance safety controls:\n- RateLimiter (token bucket)\n- TokenBudget (hard cap)\n- CircuitBreaker (fail-fast)\n- PerformanceSafeguards (composite)\n\nüìç [safeguards/limits.py](../src/dytopo/safeguards/limits.py)","x":410,"y":-520,"width":280,"height":300,"color":"1"},
		{"id":"manager","type":"text","text":"## Manager Agent\n\nSets goals and decides termination:\n- Analyzes round history\n- Generates round goals\n- Determines when task complete\n- Extracts final answer\n\nüìç [agents.py](../src/dytopo/agents.py)","x":-201,"y":-528,"width":280,"height":330,"color":"3"},
		{"id":"workers","type":"text","text":"## Worker Agents\n\nDomain-specific specialist agents:\n- Developer, Researcher, Tester, Designer\n- Problem Parser, Solver, Verifier\n- Analyst, Critic, Synthesizer\n\nEach generates key/query/work\n\nüìç [agents.py](../src/dytopo/agents.py)","x":-519,"y":-513,"width":290,"height":300,"color":"2"},
		{"id":"verifier","type":"text","text":"## OutputVerifier\n\nDeterministic output verification:\n- Syntax check\n- Schema validation\n- Fail-open on timeout\n- Pre-consensus quality gate\n\nüìç [verifier.py](../src/dytopo/verifier.py)","x":105,"y":-580,"width":290,"height":280,"color":"2"},
		{"id":"policy","type":"text","text":"## PolicyEnforcer\n\nDeny-first PCAS-Lite tool-call policy:\n- Allowlist / blocklist rules\n- Per-agent tool restrictions\n- Pre-execution validation\n- Audit trail integration\n\nüìç [policy.py](../src/dytopo/policy.py)","x":720,"y":-528,"width":280,"height":308,"color":"1"},
		{"id":"stalemate","type":"text","text":"## StalemateDetector\n\nAdvanced stall detection:\n- Ping-pong detection\n- No-progress detection\n- Regression detection\n- Triggers re-delegation or abort\n\nüìç [governance.py](../src/dytopo/governance.py)","x":1080,"y":-198,"width":280,"height":298,"color":"1"},
		{"id":"audit","type":"text","text":"## Audit Log\n\nJSONL event logging:\n- Swarm lifecycle events\n- Agent execution tracking\n- Routing decisions\n- Convergence events\n- Failure records\n\nüìç [audit.py](../src/dytopo/audit.py)","x":-229,"y":700,"width":260,"height":300,"color":"6"},
		{"id":"visualizer","type":"text","text":"## Trace Visualizer\n\nCLI trace visualization:\n- Mermaid diagram generation\n- HTML trace output\n- Round-by-round replay\n- Agent interaction graphs\n\nüìç [visualize_trace.py](../src/dytopo/visualize_trace.py)","x":-518,"y":930,"width":260,"height":300,"color":"6"},
		{"id":"observability","type":"text","text":"## Observability Layer\n\nDistributed tracing & metrics:\n- TraceContext (contextvars propagation)\n- Span collection & analysis\n- MetricsCollector (p50/p95/p99, Prometheus)\n- PerformanceProfiler & BottleneckAnalyzer\n- FailureAnalyzer (pattern detection)\n\nüìç [observability/](../src/dytopo/observability/)","x":75,"y":700,"width":320,"height":390,"color":"6"},
		{"id":"delegation","type":"text","text":"## Delegation\n\nSubtask delegation system:\n- Depth-limited nesting\n- Concurrency control via semaphore\n- Timeout protection\n- Lineage tracking\n\nüìç [delegation/manager.py](../src/dytopo/delegation/manager.py)","x":420,"y":680,"width":280,"height":300,"color":"3"},
		{"id":"health","type":"text","text":"## Health Checker\n\nPre-run stack health probes:\n- LLM endpoint (/v1/models)\n- Qdrant (/collections)\n- AnythingLLM (/api/v1/system)\n- GPU (nvidia-smi)\n- Parallel async probes\n- Non-fatal (only LLM aborts)\n\nüìç [health/checker.py](../src/dytopo/health/checker.py)","x":740,"y":610,"width":310,"height":340,"color":"5"},
		{"id":"governance","type":"text","text":"## Governance Layer\n\nFailure resilience & adaptation:\n- Convergence detection\n- Stalling detection\n- Re-delegation recommendations\n- Aegean consensus voting\n- Consensus matrix computation\n- Graceful failure handling\n- Agent metrics tracking\n\nüìç [governance.py](../src/dytopo/governance.py)","x":640,"y":120,"width":300,"height":370,"color":"1"},
		{"id":"stigmergic","type":"text","text":"## Stigmergic Router\n\nTrace-aware topology construction:\n- Wraps existing routing pipeline\n- Deposits swarm traces to Qdrant\n- Retrieves similar past traces\n- Time-decayed boost matrix\n- Quality-gated persistence\n- Collection: swarm_traces (384-dim)\n\nüìç [stigmergic_router.py](../src/dytopo/stigmergic_router.py)","x":-1067,"y":660,"width":345,"height":340,"color":"3"},
		{"id":"checkpoint","type":"text","text":"## CheckpointManager\n\nAtomic crash recovery:\n- Pydantic v2 serialization\n- Round-level state snapshots\n- Atomic file writes (tmp + rename)\n- Auto-resume on restart\n- Configurable retention\n\nüìç [checkpoint.py](../src/dytopo/checkpoint.py)","x":-706,"y":610,"width":280,"height":320,"color":"3"},
		{"id":"routing","type":"text","text":"## Routing Engine\n\nSemantic message routing:\n- Descriptor embedding (key/query)\n- Cosine similarity matching\n- DAG construction & cycle breaking\n- Topological tiers for parallel execution\n- AsyncRoutingEngine with embed lock\n\nüìç [router.py](../src/dytopo/router.py)\nüìç [graph.py](../src/dytopo/graph.py)\nüìç [routing/async_engine.py](../src/dytopo/routing/async_engine.py)\nüìç [stigmergic_router.py](../src/dytopo/stigmergic_router.py)","x":-603,"y":160,"width":345,"height":365,"color":"5"},
		{"id":"messaging","type":"text","text":"## Messaging\n\nTyped agent message passing:\n- AgentMessage (structured payloads)\n- MessageHistory (per-agent, prunable)\n- MessageRouter (graph-aware delivery)\n\nüìç [messaging/router.py](../src/dytopo/messaging/router.py)","x":-866,"y":-563,"width":320,"height":315,"color":"5"},
		{"id":"memory","type":"text","text":"## Memory Writer\n\nPost-run persistence:\n- SwarmMemoryRecord (Pydantic)\n- Task, domain, agents, rounds\n- Key findings & final answer\n- Convergence status\n- Token count & wall time\n- JSON storage\n\nüìç [memory/writer.py](../src/dytopo/memory/writer.py)","x":-1067,"y":-248,"width":280,"height":340,"color":"3"}
	],
	"edges":[
		{"id":"edge1","fromNode":"manager","fromSide":"bottom","toNode":"orchestrator","toSide":"top","label":"sets goals"},
		{"id":"edge2","fromNode":"orchestrator","fromSide":"left","toNode":"workers","toSide":"bottom","label":"coordinates"},
		{"id":"edge3","fromNode":"orchestrator","fromSide":"left","toNode":"routing","toSide":"right","label":"builds graph"},
		{"id":"edge4","fromNode":"routing","fromSide":"top","toNode":"workers","toSide":"bottom","label":"routes messages"},
		{"id":"edge5","fromNode":"governance","fromSide":"left","toNode":"orchestrator","toSide":"right","label":"monitors"},
		{"id":"edge6","fromNode":"observability","fromSide":"top","toNode":"orchestrator","toSide":"bottom","label":"instruments"},
		{"id":"edge7","fromNode":"audit","fromSide":"top","toNode":"orchestrator","toSide":"bottom","label":"logs events"},
		{"id":"edge8","fromNode":"messaging","fromSide":"bottom","toNode":"routing","toSide":"left","label":"delivers messages"},
		{"id":"edge9","fromNode":"safeguards","fromSide":"bottom","toNode":"orchestrator","toSide":"top","label":"rate limits"},
		{"id":"edge10","fromNode":"delegation","fromSide":"top","toNode":"orchestrator","toSide":"bottom","label":"sub-swarms"},
		{"id":"edge11","fromNode":"health","fromSide":"top","toNode":"orchestrator","toSide":"bottom","label":"preflight check"},
		{"id":"edge12","fromNode":"memory","fromSide":"right","toNode":"orchestrator","toSide":"left","label":"persists results"},
		{"id":"edge_stig_routing","fromNode":"stigmergic","fromSide":"top","toNode":"routing","toSide":"bottom","color":"3","label":"trace boost"},
		{"id":"edge_stig_memory","fromNode":"stigmergic","fromSide":"top","toNode":"memory","toSide":"bottom","color":"3","label":"persists traces"},
		{"id":"edge_orch_checkpoint","fromNode":"orchestrator","fromSide":"left","toNode":"checkpoint","toSide":"right","label":"crash recovery"},
		{"id":"edge_orch_stalemate","fromNode":"orchestrator","fromSide":"right","toNode":"stalemate","toSide":"left","label":"stall check"},
		{"id":"edge_orch_verifier","fromNode":"orchestrator","fromSide":"top","toNode":"verifier","toSide":"bottom","label":"output verify"},
		{"id":"edge_orch_policy","fromNode":"orchestrator","fromSide":"right","toNode":"policy","toSide":"bottom","label":"policy check"},
		{"id":"edge_stalemate_governance","fromNode":"stalemate","fromSide":"left","toNode":"governance","toSide":"right","label":"stall signals"},
		{"id":"edge_checkpoint_audit","fromNode":"checkpoint","fromSide":"right","toNode":"audit","toSide":"left","label":"recovery log"},
		{"id":"edge_visualizer_audit","fromNode":"visualizer","fromSide":"right","toNode":"audit","toSide":"bottom","label":"reads traces"}
	]
}